<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>Mr.Wang - Blog </title>
		<!--width=device-width 表示宽度是设备屏幕的宽度;initial-scale=1 表示初始的缩放比例;shrink-to-fit=no 自动适应手机屏幕的宽度。-->
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<!--引入public目录中的main.css文件-->
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/index/css/main.css" />
		<!--引入public目录中的初始化css文件-->
		<link rel="stylesheet" type="text/css" href="__PUBLIC__/index/css/initial.css" />
		<!--引入public目录中的ico图标-->
		<link rel="shortcut icon" href="__PUBLIC__/index/img/favicon.ico">
		<link href="__PUBLIC__/admin/style/page.css" rel="stylesheet">
		<!--引入cdn图标-->
		<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">
		<!-- 新 Bootstrap4 核心 CSS 文件 -->
		<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
		<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
		<script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
		<!-- popper.min.js 用于弹窗、提示、下拉菜单 -->
		<script src="https://cdn.staticfile.org/popper.js/1.12.5/umd/popper.min.js"></script>
		<!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->
		<script src="https://cdn.staticfile.org/twitter-bootstrap/4.1.0/js/bootstrap.min.js"></script>
		<link rel="stylesheet" href="__PUBLIC__/editor/editormd.min.css" />
		<!-- Include Editor style. -->
		<link href='https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/css/froala_editor.min.css' rel='stylesheet' type='text/css' />
		<link href='https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/css/froala_style.min.css' rel='stylesheet' type='text/css' />
		<!-- Include JS file. -->
		<script type='text/javascript' src='https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/js/froala_editor.min.js'></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.css">

		<!-- Include Editor style. -->
		<link href="https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/css/froala_editor.pkgd.min.css" rel="stylesheet" type="text/css" />
		<link href="https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/css/froala_style.min.css" rel="stylesheet" type="text/css" />
		<style type="text/css">
			#main .article{
				margin-top: 15px;
			}
			#main .article h3{
				text-align: center;
			}
			#main .article  ul{
				width: 80%;
				margin: 0 auto;
			}
			.article ul span{
				cursor: pointer;
			}
			#main .article  ul a{
				color: #000!important;
			}
			#main .board_table {
				background-color: #fff;
				padding: 10px;
				margin-bottom: 20px;
			}
			
			#main .board_info {
				display: inline-block;
			}
			
			#main .board img {
				margin-top: -40px;
				margin-right: 10px;
			}
			
			#main .board .board_info_review {
				background-color: #5957c2;
				width: 100%;
				height: 25px;
			}
			
			#main .board_info_text {
				margin-left: 20px!important;
			}
			
			#main .review {
				margin-left: 50px;
			}
			
			.website_data li {
				height: 40px;
				line-height: 15px;
			}
			#main .message_p {
				font-size: 20px;
				font-weight: 500;
			}
		</style>
	</head>

	<body>
		<!--导航栏开始-->
		<div class="navbar navbar-expand-md bg-dark navbar-dark fixed-top" id="nav">
			<div class="container text-center">
				<a class="navbar-brand" href="#">Cat</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
    				<span class="navbar-toggler-icon"></span>
  				</button>
				<div class="collapse navbar-collapse" id="collapsibleNavbar">
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link active" href="{:url('index/index')}">首页</a>
						</li>
						<!-- Dropdown -->
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
								技术
							</a>
							<div class="dropdown-menu text-center" id="menu">
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'前端'))}">前端</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'PHP'))}">PHP</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'Python'))}">Python</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'Linux'))}">Linux</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'Java'))}">Java</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'Android'))}">Android</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'C语言'))}">C语言</a>
								<a class="dropdown-item" href="{:url('technology/index',array('tag1'=>'Security'))}">网络安全</a>
							</div>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{:url('project/index')}">项目</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{:url('diary/index')}">日志</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{:url('essay/index')}">随笔</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{:url('board/index')}">留言板</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{:url('about/index')}">关于</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!--导航栏结束-->

		<!--主体内容开始-->
		<div id="main" class="container">
			<div class="row">

				<div class="col-xs-12 col-md-12 col-lg-10" id="warp">
					<nav class="breadcrumb">
						<a class="breadcrumb-item" href="#">Blog</a>
						<a class="breadcrumb-item active" href="#">首页</a>

					</nav>
					
					<div class="article">
						<h3>
							<a href="{:url('index/show',array('id'=>$vo['id']))}" class="article_title">{$vo.title}</a>
						</h3>
						<ul class="clearfix">
							<li class="article_author"><i class="fa fa-user"></i>&nbsp;{$vo.author}</li>
							<li class="article_time"><i class="fa fa-calendar"></i>&nbsp;<span title="{$vo.create_time|date="Y-m-d H:i:s"}">{$vo.create_time|date="y-m-d"}</span></li>
							<li class="article_read"><i class="fa fa-check-square"></i>&nbsp;{$vo.read_times}</li>
							<li class="article_comment"><i class="fa fa-comment"></i>&nbsp;{$vo.comment_times}</li>
							<li class="article_cate1"><i class="fa fa-list-alt"></i>&nbsp;<a href="#" title="{$vo.tag1}">{$vo.tag1}</a></li>
							<li class="article_cate2"><i class="fa fa-tags"></i>&nbsp;<a href="#" title="{$vo.tag2}">{$vo.tag2}</a></li>
						</ul>
						
					</div>
					
					<div class="editormd-preview-theme-dark">
							<div id="test-editormd-view" class="markdown-body editormd-preview-container">
								<textarea style="display:none;">{$vo.text}</textarea>
							</div>
					</div>
					<p style="margin-top: 10px;">评论列表</p>
					<div class="board" >
						{volist name="list" id='vo1'}
						{if condition="$vo1['level'] eq 0"}
						<div class="board_table">
							<img src="__PUBLIC__/index/img/photo.jpg" class="img-fluid rounded" />
							<div class="board_info">
								<div class="board_info_review">
									<p>游客 : {$vo1.name} {$vo1.create_time|date="Y-m-d H:i:s"} </p>
								</div>
								<p class="board_info_text">
									<div class="fr-view" >
  					 					{$vo1.text|raw}
									</div>
								</p>
							</div>
							{foreach $list as $k=>$vo3 } 
							{if condition="$vo3['level'] eq 1 and $vo3['pid'] eq $vo1['id']"}
							<div class="review ">
								<img src="__PUBLIC__/index/img/photo1.jpg" class="img-fluid rounded" />
								<div class="board_info">
									<div class="review_info board_info_review">
										<p>管理员 : admin {$vo3.create_time|date="Y-m-d H:i:s"}</p>
									</div>
									<p class="review_text">
										<div class="fr-view" >
  					 						{$vo3.text|raw}
										</div>
									</p>
								</div>
							</div>
							{/if}
							{/foreach}
						</div>
						{/if}
						{/volist}
						<div style="text-align: right;margin-top: 10px;" class="d-flex justify-content-center">
							{$list|raw}
						</div>
					<p class="message_p">有啥问题,尽情评论喔~~</p>
						<div class="message_box">
							<form action="">
								<input type="hidden" value="{$vo.id}" name="article_id"/>
								<input type="hidden" value="0" name="diary_id"/>
								<div class="row">
									<div class="input-group mb-3 col-xs-6 col-md-6 col-lg-6">
										<div class="input-group-prepend">
											<span class="input-group-text">昵称</span>
										</div>
										<input type="text" class="form-control" placeholder="昵称将会被显示(必填)" id="usr" name="name">
									</div>

									<div class="input-group mb-3 col-xs-6 col-md-6 col-lg-6">
										<div class="input-group-append">
											<span class="input-group-text">邮箱</span>
										</div>
										<input type="text" class="form-control" placeholder="邮箱不会被公开(必填)" id="mail" name="email">

									</div>

								</div>
								<textarea id="board"></textarea>
								<input type="hidden" id="editorText" value="" name="editorText" />
								<button type="submit" class="btn btn-primary" id="toSave" style="margin-bottom: 20px; margin-top: 10px;">发表评论</button>

							</form>
						</div>

					
				</div>
				
				<div class="col-lg-2 d-none d-sm-block" id="banner_right">

				</div>
			</div>

		</div>
		<!--主体内容结束-->
		<!--copyright开始-->
		<div id="copyright">
			<p>copyright &nbsp;2019-2020 @
				<a href="#">wh241.com</a>
			</p>
		</div>
		<!--copyright结束-->
		<script src="__PUBLIC__/editor/lib/marked.min.js"></script>
		<script src="__PUBLIC__/editor/lib/prettify.min.js"></script>
		<script src="__PUBLIC__/editor/lib/raphael.min.js"></script>
		<script src="__PUBLIC__/editor/lib/underscore.min.js"></script>
		<script src="__PUBLIC__/editor/lib/sequence-diagram.min.js"></script>
		<script src="__PUBLIC__/editor/lib/flowchart.min.js"></script>
		<script src="__PUBLIC__/editor/lib/jquery.flowchart.min.js"></script>
		<script src="__PUBLIC__/editor/editormd.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/xml/xml.min.js"></script>

		<!-- Include Editor JS files. -->

		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/froala-editor@2.9.3/js/froala_editor.pkgd.min.js"></script>
		<script src='__PUBLIC__/froala_editor/js/languages/zh_cn.js'></script>
		<script src="__PUBLIC__/layui/layui.js"></script>
		<!-- Initialize the editor. -->
		<script>
			$(function() {
				$('#board').froalaEditor({
					language: 'zh_cn',
					heightMin: 100,
					heightMax: 600,
					placeholderText: '亲亲，这边建议您留下评论呢~~',
					pastePlain: true,
					tooltips: false,
					theme: 'dark',
					quickInsertTags: [''],
					toolbarButtons: ['emoticons'],
					toolbarStickyOffset: 53,
				});
				
				layui.use('upload', function() {
					var upload = layui.upload;
					var layer = layui.layer;
					
				});
				$('#toSave').click(function() {
						var html= $('#board').froalaEditor('html.get');
						$('#editorText').val(html);
						$.ajax({
							url: "{:url('comment/add')}",
							type: 'post',
							data: $('form').serialize(),
							dataType: 'json',
							success: function(data) {
								console.log(data);
								if(data.code == 1) {
									layer.msg(data.msg, {
										icon: 6,
										time: 2000
									}, function() {
										location.href = data.url;
									});
								} else {
									layer.open({
										title: '评论失败',
										content: data.msg,
										icon: 5,
										anim: 6
									});
								}
							},
							error: function(data) {
								console.log(data);
							}
						});
						return false;
					});
			});
		</script>
		<script type="text/javascript">
			testEditormdView2 = editormd.markdownToHTML("test-editormd-view", {
				htmlDecode: "style,script,iframe", // you can filter tags decode
				emoji: true,
				taskList: true,
				tex: true, // 默认不解析
				flowChart: true, // 默认不解析
				sequenceDiagram: true, // 默认不解析
			});
		</script>

	</body>

</html>
